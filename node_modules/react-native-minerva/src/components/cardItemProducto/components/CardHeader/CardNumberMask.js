import React, { memo } from 'react';
import PropTypes from 'prop-types';
import { isArray } from 'lodash';
import { Text, HelperStyle, IconCircleFill, View } from '../../../../index';

/**
 * Componente que enmascara el numero del producto retornando 3 puntos y los Ãºltimos 4 numeros en el children.
 *
 * @component
 */
const CardNumberMask = (props) => {
    const { children, style, styleContainer } = props;

    const ultimos4digitos = children.split('****')[1];
    let colorIconCircleFill = null;
    if (isArray(style)) {
        style.forEach((element) => {
            if (
                Object.keys(element).findIndex((elem) => elem === 'color') >= 0
            ) {
                colorIconCircleFill = { color: element.color };
            }
        });
    } else {
        colorIconCircleFill = { color: style?.color };
    }

    return (
        <View style={[HelperStyle.flx_row, styleContainer]}>
            <IconCircleFill style={colorIconCircleFill} />
            <Text
                number
                numberOfLines={1}
                ellipsizeMode="tail"
                {...props}
                style={[
                    HelperStyle.ml_2,
                    HelperStyle.mb_0,
                    HelperStyle.flx_shrink,
                    HelperStyle.flx_wrap,
                    style,
                ]}
            >
                {ultimos4digitos}
            </Text>
        </View>
    );
};

CardNumberMask.propTypes = {
    children: PropTypes.node.isRequired,
    styleContainer: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),
    style: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),
};
CardNumberMask.defaultProps = {
    styleContainer: {},
    style: {},
};

export default memo(CardNumberMask);
