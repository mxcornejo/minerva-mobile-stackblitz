import React from 'react';
import { render } from '@testing-library/react-native';
import { Text, MapList } from '../../../src/index';

describe('Test componente <MapList />', () => {
    const renderItem = ({ item }) => <Text>{item.name}</Text>;
    const mockKeyExtractor = jest.fn((item) => `custom-${item.index}`);
    const data = [
        {
            index: 0,
            name: 'Marina Ballard',
        },
        {
            index: 1,
            name: 'Lela Lamb',
        },
        {
            index: 2,
            name: 'Olson Pitts',
        },
    ];

    test('Debería renderizar correctamente', () => {
        const { toJSON } = render(
            <MapList data={data} renderItem={renderItem} />,
        );
        expect(toJSON()).toMatchSnapshot();
    });

    test('Debería renderizar con keyExtractor personalizado', () => {
        render(
            <MapList
                data={data}
                renderItem={renderItem}
                keyExtractor={mockKeyExtractor}
                wrapper={false}
            />,
        );
        expect(mockKeyExtractor.mock.calls.length).toBe(data.length);
    });

    test('Debería renderizar con estado y component loading', () => {
        const textLoading = 'Componente Loading';
        const ListLoadingComponent = () => <Text>{textLoading}</Text>;
        const { getByText } = render(
            <MapList
                data={data}
                loading
                renderItem={renderItem}
                ListLoadingComponent={ListLoadingComponent}
            />,
        );
        expect(getByText(textLoading)).toBeDefined();
    });
});
