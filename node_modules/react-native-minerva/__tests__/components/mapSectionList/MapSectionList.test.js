import React from 'react';
import { render } from '@testing-library/react-native';
import { MapSectionList } from '../../../src';

const mockRender = jest.fn();
const mockKeyExtractor = jest.fn((item, index) => `item-${index}`);

describe('Test componente <MapSectionList />', () => {
    const props = {
        sections: [
            {
                header: '25/09/2021',
                data: [
                    {
                        title: 'Sint tempor ullamco sunt culpa ad eu sint qui id ad reprehenderit.',
                    },
                ],
            },
            {
                header: '25/09/2021',
                data: [
                    {
                        title: 'Cupidatat nisi labore sit anim proident anim quis non voluptate ex occaecat aute mollit non.',
                    },
                ],
            },
        ],
    };

    test('Debería renderizar correctamente', () => {
        const { sections } = props;
        const { toJSON } = render(
            <MapSectionList
                sections={sections}
                renderItem={mockRender}
                renderSectionHeader={mockRender}
            />,
        );
        expect(toJSON()).toMatchSnapshot();
    });

    test('Debería llamar al keyExtractor', () => {
        const { sections } = props;
        const { getByTestId } = render(
            <MapSectionList
                sections={sections}
                renderItem={mockRender}
                renderSectionHeader={mockRender}
                keyExtractor={mockKeyExtractor}
                testID="test_MapSectionList"
            />,
        );
        expect(getByTestId).toBeDefined();
        expect(mockKeyExtractor).toHaveBeenCalledTimes(4);
    });

    test('Debería renderizar componente por defecto para estado vacío', () => {
        const { getByTestId } = render(
            <MapSectionList sections={[]} renderItem={mockRender} />,
        );
        expect(getByTestId).toBeDefined();
    });
});
