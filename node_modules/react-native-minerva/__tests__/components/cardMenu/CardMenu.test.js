import React from 'react';
import { fireEvent, render } from '@testing-library/react-native';
import Images from 'bch-assets';
import CardMenu from '../../../src/components/cardMenu/CardMenu';
import { HelperStyle, View, Text } from '../../../src/index';
import CARDMENU_STR from '../../../src/components/cardMenu/CardMenuStr';

const {
    miInversion: {
        productos: { fondosMutuos },
    },
} = Images;

const iconName = 'icon-bch-barcode';
const subtitle = 'Aute adipisicing excepteur ex dolor exercitation eiusmod.';
const renderOptions = () => (
    <View>
        <Text bold>Options personalizado: </Text>
    </View>
);

describe('Test componente <CardMenu />', () => {
    const data = [
        {
            cardItemTestID: 'IDCardItem',
            iconName,
            title: 'Opcion 1',
            onPress: () => null,
            collapsed: false,
            options: [
                { title: 'Sub opcion 1', onPress: () => null },
                { title: 'Sub opcion 2', onPress: () => null },
                { title: 'Sub opcion 3', onPress: () => null },
            ],
            buttonsGroup: {
                horizontal: true,
                items: [
                    {
                        title: 'primary',
                        props: { primary: true, small: true },
                    },
                    {
                        title: 'secondary',
                        props: { secondary: true, small: true },
                    },
                ],
            },
        },
        {
            imageSource: fondosMutuos,
            cardAccessibilityLabel: 'label',
            iconStyle: HelperStyle.primary,
            title: 'Opcion 2',
            subtitle,
            onPress: () => null,
            collapsed: false,
            options: [
                { title: 'Sub opcion 1', onPress: () => null },
                { title: 'Sub opcion 2', onPress: () => null },
                { title: 'Sub opcion 3', onPress: () => null },
            ],
        },
        {
            iconLabel: 'Opcion 3',
            iconStyle: HelperStyle.success,
            title: 'Opcion 3',
            subtitle,
            onPress: () => null,
        },
        {
            iconName,
            iconLabel: 'Opcion 4',
            iconStyle: HelperStyle.danger,
            subtitle,
            title: 'Opcion 4',
            onPress: () => null,
            collapsed: false,
            renderOptions,
        },
    ];
    test('Debería renderizar correctamente', () => {
        const { toJSON } = render(
            <CardMenu style={HelperStyle.mb_4} data={data} />,
        );
        expect(toJSON()).toMatchSnapshot();
    });

    test('Debería colapsar contenido', () => {
        const { getByTestId } = render(
            <CardMenu style={HelperStyle.mb_4} data={data} />,
        );
        const elemCardItem = getByTestId('IDCardItem');
        fireEvent.press(elemCardItem);
        const elemIcon = getByTestId(CARDMENU_STR.iconos.mostrarSubMenu.testID);
        expect(elemIcon).toBeDefined();
    });
});
