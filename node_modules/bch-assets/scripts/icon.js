'use strict';

const fs = require('fs');
const rawdataIcons = fs.readFileSync('./fonts/selection.json');
const rawdataDB = fs.readFileSync('./db.json');
const selectionFile = JSON.parse(rawdataIcons);
const dbFile = JSON.parse(rawdataDB);
const numberOfIcons = selectionFile.icons.length;
const data = JSON.stringify({
    file: 'selection.json',
    fontName: 'icomoon',
    numberOfIcons,
});

if (dbFile.numberOfIcons > numberOfIcons){
    console.info('\x1b[31m%s\x1b[0m', `ERROR: Número de iconos es menor al anterior.`);
    console.info('\x1b[31m%s\x1b[0m', `ERROR: Número de iconos anterior: ${dbFile.numberOfIcons}. Nuevo número de iconos: ${numberOfIcons}.`);
}else{
    console.info('\x1b[32m%s\x1b[0m', 'SUCCESS: Actualizado archivo db.json.');
    console.info('\x1b[36m%s\x1b[0m', `INFO:    Numero de iconos: ${numberOfIcons}.`);
    fs.writeFileSync('./db.json', data);
}